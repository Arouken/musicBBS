<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.bbs.dao.MainPostDao">
	
	<!-- 获取所有帖子信息 -->
<!-- 	<select id="getMainPostList"  resultType="com.bbs.pojo.MainPost"> -->
<!-- 		select * from main_post -->
<!-- 	</select> -->
	
	<select id="getMainPostList"  resultMap="mainPostUser">
		select * from main_post
	</select>	
	<resultMap type="com.bbs.pojo.MainPost" id="mainPostUser">
		<result property="userID" column="userID"/>
		<result property="mainPostID" column="mainPostID"/>
		<result property="mainPostTitle" column="mainPostTitle"/>
		<result property="mainPostTime" column="mainPostTime"/>
		<result property="mainPostContent" column="mainPostContent"/>
		<result property="mainPostGoodCount" column="mainPostGoodCount"/>
		<result property="mainPostBadCount" column="mainPostBadCount"/>
		<result property="mainPostIsLOcked" column="mainPostIsLOcked"/>
		<result property="mainPostImg" column="mainPostImg"/>
		<association property="user" column="userID" javaType="com.bbs.pojo.User" select="getUser">
		</association>
		
	</resultMap>
	<!-- 用于展示帖子用户信息	 -->
	<select id="getUser"  resultType="com.bbs.pojo.User">
		select * from user where userID = #{userID}
	</select>
	<!--是否已赞 -->
<!-- 	<select id="getLikePost" parameterType="String" resultType="com.bbs.pojo.LikeMainPost"> -->
<!-- 		select * from likemainpost where userID = #{myuserID} and mainPostID=#{mainPostID} -->
<!-- 	</select> -->
	
	<!-- 发帖子 -->
	<insert id="addMainPost" parameterType="com.bbs.pojo.MainPost">
		insert into main_post(userID,mainPostTitle,mainPostTime,mainPostContent,mainPostImg) 
		values(#{userID},#{mainPostTitle},#{mainPostTime},#{mainPostContent},#{mainPostImg})
	</insert>
	
	<!-- 获取一个帖子信息 -->
	<select id="getOneMainPost" parameterType="int" resultMap="oneMainPostUser">
		select * from main_post where mainPostID = #{mainPostID}
	</select>	
	<resultMap type="com.bbs.pojo.MainPost" id="oneMainPostUser">
		<result property="userID" column="userID"/>
		<result property="mainPostID" column="mainPostID"/>
		<result property="mainPostTitle" column="mainPostTitle"/>
		<result property="mainPostTime" column="mainPostTime"/>
		<result property="mainPostContent" column="mainPostContent"/>
		<result property="mainPostIsLOcked" column="mainPostIsLOcked"/>
		<result property="mainPostImg" column="mainPostImg"/>
		<association property="user" column="userID" javaType="com.bbs.pojo.User" select="getUser">
		</association>
	</resultMap>
	<!-- 点赞,赞加一 -->
	<update id="addLikeCount" parameterType="com.bbs.pojo.MainPost">
		update main_post set mainPostLikeCount=mainPostLikeCount+1 where mainPostID = #{mainPostID}
	</update>
	
	<!-- 取消点赞，赞减一 -->
	<update id="deleteLikeCount" parameterType="com.bbs.pojo.MainPost">
		update main_post set mainPostLikeCount=mainPostLikeCount-1 where mainPostID = #{mainPostID}
	</update>
	
	<!-- 收藏,收藏加一 -->
	<update id="addCollectCount" parameterType="com.bbs.pojo.MainPost">
		update main_post set mainPostCollectCount=mainPostCollectCount+1 where mainPostID = #{mainPostID}
	</update>
	
	<!-- 取消收藏，收藏减一 -->
	<update id="deleteCollectCount" parameterType="com.bbs.pojo.MainPost">
		update main_post set mainPostCollectCount=mainPostCollectCount-1 where mainPostID = #{mainPostID}
	</update>
	
	
	

</mapper>